<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Table of Content Table of Content Basic Structure 1. PE File 2. MS-DOS stub DOS Header DOS stub Rich Header   3. NT Header NT Signature File Header Optional Header   4. Section Header 5. Sections Stan">
<meta property="og:type" content="article">
<meta property="og:title" content="PE Format">
<meta property="og:url" content="https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/index.html">
<meta property="og:site_name" content="Enclave NO.0X7971">
<meta property="og:description" content="Table of Content Table of Content Basic Structure 1. PE File 2. MS-DOS stub DOS Header DOS stub Rich Header   3. NT Header NT Signature File Header Optional Header   4. Section Header 5. Sections Stan">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://yuqidai.github.io/images/pe/pe_structure.PNG">
<meta property="article:published_time" content="2024-03-31T16:00:01.000Z">
<meta property="article:modified_time" content="2024-07-28T16:21:19.575Z">
<meta property="article:author" content="Dai Yuqi">
<meta property="article:tag" content="security basic">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yuqidai.github.io/images/pe/pe_structure.PNG">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
          
        
    
    <!-- title -->
    <title>PE Format</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
<meta name="generator" content="Hexo 7.2.0"></head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Recent</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Archives</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2024/07/29/fuzz/fuzzying/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2024/03/22/risk%20management/CH4_Contingency%20Planning&Management/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&text=PE Format"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&is_video=false&description=PE Format"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=PE Format&body=Check out this article: https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&name=PE Format&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Table-of-Content"><span class="toc-number">1.</span> <span class="toc-text">Table of Content</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-Structure"><span class="toc-number">2.</span> <span class="toc-text">Basic Structure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-PE-File"><span class="toc-number">2.1.</span> <span class="toc-text">1. PE File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MS-DOS-stub"><span class="toc-number">2.2.</span> <span class="toc-text">2. MS-DOS stub</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DOS-Header"><span class="toc-number">2.2.1.</span> <span class="toc-text">DOS Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DOS-stub"><span class="toc-number">2.2.2.</span> <span class="toc-text">DOS stub</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rich-Header"><span class="toc-number">2.2.3.</span> <span class="toc-text">Rich Header</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-NT-Header"><span class="toc-number">2.3.</span> <span class="toc-text">3. NT Header</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NT-Signature"><span class="toc-number">2.3.1.</span> <span class="toc-text">NT Signature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Header"><span class="toc-number">2.3.2.</span> <span class="toc-text">File Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Optional-Header"><span class="toc-number">2.3.3.</span> <span class="toc-text">Optional Header</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Section-Header"><span class="toc-number">2.4.</span> <span class="toc-text">4. Section Header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Sections"><span class="toc-number">2.5.</span> <span class="toc-text">5. Sections</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Standard-Sections"><span class="toc-number">2.5.1.</span> <span class="toc-text">Standard Sections</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Self-defined-Sections"><span class="toc-number">2.5.2.</span> <span class="toc-text">Self-defined Sections</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Appending-Content"><span class="toc-number">2.6.</span> <span class="toc-text">6. Appending Content</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-code-of-the-data-structures-above"><span class="toc-number">3.</span> <span class="toc-text">C++ code of the data structures above</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DOS-Header-1"><span class="toc-number">3.1.</span> <span class="toc-text">DOS Header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NT-Header"><span class="toc-number">3.2.</span> <span class="toc-text">NT Header</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NT-Signature-1"><span class="toc-number">3.2.1.</span> <span class="toc-text">NT Signature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Header-1"><span class="toc-number">3.2.2.</span> <span class="toc-text">File Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Optional-Header-1"><span class="toc-number">3.2.3.</span> <span class="toc-text">Optional Header</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Section-Header"><span class="toc-number">3.3.</span> <span class="toc-text">Section Header</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Parse-PE-files"><span class="toc-number">4.</span> <span class="toc-text">Parse PE files</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#From-image"><span class="toc-number">4.1.</span> <span class="toc-text">From image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#From-Memory"><span class="toc-number">4.2.</span> <span class="toc-text">From Memory</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        PE Format
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Enclave NO.0X7971</span>
      </span>
      
    <div class="postdate">
        <time datetime="2024-03-31T16:00:01.000Z" itemprop="datePublished">2024-04-01</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/security-basic/" rel="tag">security basic</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Table-of-Content"><a href="#Table-of-Content" class="headerlink" title="Table of Content"></a>Table of Content</h2><ul>
<li><a href="#table-of-content">Table of Content</a></li>
<li><a href="#basic-structure">Basic Structure</a><ul>
<li><a href="#1-pe-file">1. PE File</a></li>
<li><a href="#2-ms-dos-stub">2. MS-DOS stub</a><ul>
<li><a href="#dos-header">DOS Header</a></li>
<li><a href="#dos-stub">DOS stub</a></li>
<li><a href="#rich-header">Rich Header</a></li>
</ul>
</li>
<li><a href="#3-nt-header">3. NT Header</a><ul>
<li><a href="#nt-signature">NT Signature</a></li>
<li><a href="#file-header">File Header</a></li>
<li><a href="#optional-header">Optional Header</a></li>
</ul>
</li>
<li><a href="#4-section-header">4. Section Header</a></li>
<li><a href="#5-sections">5. Sections</a><ul>
<li><a href="#standard-sections">Standard Sections</a></li>
<li><a href="#self-defined-sections">Self-defined Sections</a></li>
</ul>
</li>
<li><a href="#6-appending-content">6. Appending Content</a></li>
</ul>
</li>
<li><a href="#c-code-of-the-data-structures-above">C++ code of the data structures above</a><ul>
<li><a href="#dos-header-1">DOS Header</a></li>
<li><a href="#nt-header">NT Header</a><ul>
<li><a href="#nt-signature-1">NT Signature</a></li>
<li><a href="#file-header-1">File Header</a></li>
<li><a href="#optional-header-1">Optional Header</a></li>
</ul>
</li>
<li><a href="#section-header">Section Header</a></li>
</ul>
</li>
<li><a href="#parse-pe-files">Parse PE files</a><ul>
<li><a href="#from-image">From image</a></li>
<li><a href="#from-memory">From Memory</a></li>
</ul>
</li>
</ul>
<h2 id="Basic-Structure"><a href="#Basic-Structure" class="headerlink" title="Basic Structure"></a>Basic Structure</h2><p><img src="/images/pe/pe_structure.PNG" alt="img1"></p>
<h3 id="1-PE-File"><a href="#1-PE-File" class="headerlink" title="1. PE File"></a>1. PE File</h3><p>PE stands for Portable Executable, it’s a file format for executables used in Windows operating systems, it’s based on the COFF file format (Common Object File Format).</p>
<p><strong>Commonly used extensions for PE format</strong>     </p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Usage</th>
</tr>
</thead>
<tbody><tr>
<td>.exe</td>
<td>executable files</td>
</tr>
<tr>
<td>.dll</td>
<td>dynamic-link library files</td>
</tr>
<tr>
<td>.sys</td>
<td>system files</td>
</tr>
<tr>
<td>.ocx</td>
<td>ActiveX control files</td>
</tr>
<tr>
<td>.scr</td>
<td>screensaver files</td>
</tr>
<tr>
<td>.cpl</td>
<td>Control Panel extension files</td>
</tr>
<tr>
<td>.mui</td>
<td>Multilingual User Interface (MUI) files</td>
</tr>
</tbody></table>
<p>In general, A PE file is a data structure storing basic information for OS to load the file, and it also contains some meta data for non-standard usage.</p>
<h3 id="2-MS-DOS-stub"><a href="#2-MS-DOS-stub" class="headerlink" title="2. MS-DOS stub"></a>2. MS-DOS stub</h3><p>MS-DOS stub includes <em><strong>DOS Header</strong></em> and <em><strong>DOS stub</strong></em>.    </p>
<h4 id="DOS-Header"><a href="#DOS-Header" class="headerlink" title="DOS Header"></a>DOS Header</h4><p>It is a small data structure that appears at the beginning of most executable files in the Portable Executable (PE) format. It serves historical and compatibility purposes.</p>
<h4 id="DOS-stub"><a href="#DOS-stub" class="headerlink" title="DOS stub"></a>DOS stub</h4><p>MS-DOS program stub, this stub might display a message such as “This program cannot be run in MS-DOS mode” or perform other simple tasks. Its purpose is to provide a message to users attempting to run the executable in MS-DOS mode, as well as to ensure compatibility with older versions of Windows that boot with MS-DOS as the underlying platform.</p>
<h4 id="Rich-Header"><a href="#Rich-Header" class="headerlink" title="Rich Header"></a>Rich Header</h4><p>The above info is the documented info from MSFT, but actually there is an undocumented section in PE format, which is called <em><strong>Rich Header</strong></em>.<br>It is a section created by MSFT compilation toolchain, it located between the MS-DOS stub and NT Header. The content of it is obfuscated.</p>
<h3 id="3-NT-Header"><a href="#3-NT-Header" class="headerlink" title="3. NT Header"></a>3. NT Header</h3><h4 id="NT-Signature"><a href="#NT-Signature" class="headerlink" title="NT Signature"></a>NT Signature</h4><p>It is a 4 bytes long signature, typically the characters “PE\0\0” (0x50 0x45 0x00 0x00 in hexadecimal), indicating that the file is a PE format executable.</p>
<h4 id="File-Header"><a href="#File-Header" class="headerlink" title="File Header"></a>File Header</h4><p>It provides general information about the structure and properties of the PE file. This includes details such as the target machine architecture, the number of sections in the file, the timestamp of when the file was created, and other flags and characteristics.</p>
<h4 id="Optional-Header"><a href="#Optional-Header" class="headerlink" title="Optional Header"></a>Optional Header</h4><p>It contains additional information specific to the PE format. This includes details such as the size of various sections, the entry point of the executable, the preferred base address for loading the executable into memory, the address of the import table, the size of the stack and heap, and more.    </p>
<p>Inside the Optional Header, there is a very important part called <em><strong>Data Directory</strong></em>. It specify the locations and sizes of various data structures used by the executable. These data structures include the import table, export table, resource table, debug information, and more.</p>
<h3 id="4-Section-Header"><a href="#4-Section-Header" class="headerlink" title="4. Section Header"></a>4. Section Header</h3><p>It contains detailed information about each section present in the file. Each section header describes a specific segment of the PE file, such as code, data, resources, or other types of data.</p>
<h3 id="5-Sections"><a href="#5-Sections" class="headerlink" title="5. Sections"></a>5. Sections</h3><h4 id="Standard-Sections"><a href="#Standard-Sections" class="headerlink" title="Standard Sections"></a>Standard Sections</h4><p>Not all of these sections will appear in the PE file. The appearence of them depends on whether the PE file needs them or not.</p>
<ul>
<li><p>Text (or Code) Section: This section contains executable code that the program will run. It typically has read and execute permissions but not write permissions.</p>
</li>
<li><p>Data Section: This section contains initialized global and static variables used by the program. It typically has read and write permissions but not execute permissions.</p>
</li>
<li><p>Resource Section: This section contains resources such as icons, images, dialogs, strings, and other data used by the program. Resources can be accessed by the program at runtime.</p>
</li>
<li><p>Import Section: This section contains information about external functions and symbols that the program imports from DLLs or other executables. It includes import tables that specify the names and addresses of imported functions.</p>
</li>
<li><p>Export Section: This section contains information about functions and symbols that the program exports for use by other programs. It includes export tables that specify the names and addresses of exported functions.</p>
</li>
<li><p>Relocation Section: This section contains information about positions in the code and data sections that need to be adjusted if the executable is loaded at a different base address in memory. It facilitates the process of relocating the executable.</p>
</li>
<li><p>Debug Section: This section contains debugging information used by debuggers and other development tools. It includes symbols, line numbers, and other metadata for debugging purposes.</p>
</li>
<li><p>TLS (Thread Local Storage) Section: This section contains data structures used for thread-local storage, which allows variables to have unique values per thread in a multi-threaded program.</p>
</li>
<li><p>Load Configuration Section: This section contains information about the preferred base address, size of the stack and heap, and other memory allocation preferences specified by the program.</p>
</li>
</ul>
<h4 id="Self-defined-Sections"><a href="#Self-defined-Sections" class="headerlink" title="Self-defined Sections"></a>Self-defined Sections</h4><p>Developer can self-define any sections they want and combine it into the PE file. But there’s also an unwritten routine for the naming of them, for better understanding it please refer to real world PE files.</p>
<h3 id="6-Appending-Content"><a href="#6-Appending-Content" class="headerlink" title="6. Appending Content"></a>6. Appending Content</h3><p>Basically this part is not a part of standard PE file. But for many famous products, you can find that the PE file doesn’t end after all sections are loaded. There is an appending content at the end of the content of the sections.    </p>
<p>Normally this part is used to store some important information of the file, but the information is too long that not able to be stored at any of the original data structure in a PE file.</p>
<h2 id="C-code-of-the-data-structures-above"><a href="#C-code-of-the-data-structures-above" class="headerlink" title="C++ code of the data structures above"></a>C++ code of the data structures above</h2><p>You can find all of the following code in header &lt;winnt.h&gt;.</p>
<h3 id="DOS-Header-1"><a href="#DOS-Header-1" class="headerlink" title="DOS Header"></a>DOS Header</h3><pre><code><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IMAGE_DOS_HEADER</span> &#123;</span><br><span class="line">    WORD  e_magic;      <span class="comment">/* 00: MZ Header signature */</span></span><br><span class="line">    WORD  e_cblp;       <span class="comment">/* 02: Bytes on last page of file */</span></span><br><span class="line">    WORD  e_cp;         <span class="comment">/* 04: Pages in file */</span></span><br><span class="line">    WORD  e_crlc;       <span class="comment">/* 06: Relocations */</span></span><br><span class="line">    WORD  e_cparhdr;    <span class="comment">/* 08: Size of header in paragraphs */</span></span><br><span class="line">    WORD  e_minalloc;   <span class="comment">/* 0a: Minimum extra paragraphs needed */</span></span><br><span class="line">    WORD  e_maxalloc;   <span class="comment">/* 0c: Maximum extra paragraphs needed */</span></span><br><span class="line">    WORD  e_ss;         <span class="comment">/* 0e: Initial (relative) SS value */</span></span><br><span class="line">    WORD  e_sp;         <span class="comment">/* 10: Initial SP value */</span></span><br><span class="line">    WORD  e_csum;       <span class="comment">/* 12: Checksum */</span></span><br><span class="line">    WORD  e_ip;         <span class="comment">/* 14: Initial IP value */</span></span><br><span class="line">    WORD  e_cs;         <span class="comment">/* 16: Initial (relative) CS value */</span></span><br><span class="line">    WORD  e_lfarlc;     <span class="comment">/* 18: File address of relocation table */</span></span><br><span class="line">    WORD  e_ovno;       <span class="comment">/* 1a: Overlay number */</span></span><br><span class="line">    WORD  e_res[<span class="number">4</span>];     <span class="comment">/* 1c: Reserved words */</span></span><br><span class="line">    WORD  e_oemid;      <span class="comment">/* 24: OEM identifier (for e_oeminfo) */</span></span><br><span class="line">    WORD  e_oeminfo;    <span class="comment">/* 26: OEM information; e_oemid specific */</span></span><br><span class="line">    WORD  e_res2[<span class="number">10</span>];   <span class="comment">/* 28: Reserved words */</span></span><br><span class="line">    DWORD e_lfanew;     <span class="comment">/* 3c: Offset to extended header */</span></span><br><span class="line">&#125; IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;</span><br></pre></td></tr></table></figure>
</code></pre>
<h3 id="NT-Header"><a href="#NT-Header" class="headerlink" title="NT Header"></a>NT Header</h3><p>There are two types of NT Headers, 32-bits and 64-bits version. The only difference between them is the structure of <em><strong>Optional Header</strong></em>.</p>
<ul>
<li><p>NT Header 64 bits</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IMAGE_NT_HEADERS64</span> &#123;</span><br><span class="line">    DWORD Signature;</span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;</span><br><span class="line">    IMAGE_OPTIONAL_HEADER64 OptionalHeader;</span><br><span class="line">&#125; IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64;</span><br></pre></td></tr></table></figure>
</li>
<li><p>NT Header 32 bits</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IMAGE_NT_HEADERS</span> &#123;</span><br><span class="line">    DWORD Signature; <span class="comment">/* &quot;PE&quot;\0\0 */</span>	<span class="comment">/* 0x00 */</span></span><br><span class="line">    IMAGE_FILE_HEADER FileHeader;		<span class="comment">/* 0x04 */</span></span><br><span class="line">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;	<span class="comment">/* 0x18 */</span></span><br><span class="line">&#125; IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="NT-Signature-1"><a href="#NT-Signature-1" class="headerlink" title="NT Signature"></a>NT Signature</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> IMAGE_NT_SIGNATURE     0x00004550 <span class="comment">/* PE00 */</span></span></span><br></pre></td></tr></table></figure>

<h4 id="File-Header-1"><a href="#File-Header-1" class="headerlink" title="File Header"></a>File Header</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IMAGE_FILE_HEADER</span> &#123;</span><br><span class="line">    WORD  Machine;</span><br><span class="line">    WORD  NumberOfSections;</span><br><span class="line">    DWORD TimeDateStamp;</span><br><span class="line">    DWORD PointerToSymbolTable;</span><br><span class="line">    DWORD NumberOfSymbols;</span><br><span class="line">    WORD  SizeOfOptionalHeader;</span><br><span class="line">    WORD  Characteristics;</span><br><span class="line">&#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</span><br></pre></td></tr></table></figure>

<h4 id="Optional-Header-1"><a href="#Optional-Header-1" class="headerlink" title="Optional Header"></a>Optional Header</h4><p>There are 32 bits and 64 bits Optional Header. The former one contains one more variable: </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DWORD BaseOfData</span><br></pre></td></tr></table></figure>

<ul>
<li><p>32 bits Optional Header</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IMAGE_OPTIONAL_HEADER</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Standard fields */</span></span><br><span class="line"></span><br><span class="line">    WORD  Magic; <span class="comment">/* 0x10b or 0x107 */</span>	<span class="comment">/* 0x00 */</span></span><br><span class="line">    BYTE  MajorLinkerVersion;</span><br><span class="line">    BYTE  MinorLinkerVersion;</span><br><span class="line">    DWORD SizeOfCode;</span><br><span class="line">    DWORD SizeOfInitializedData;</span><br><span class="line">    DWORD SizeOfUninitializedData;</span><br><span class="line">    DWORD AddressOfEntryPoint;		<span class="comment">/* 0x10 */</span></span><br><span class="line">    DWORD BaseOfCode;</span><br><span class="line">    DWORD BaseOfData;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* NT additional fields */</span></span><br><span class="line"></span><br><span class="line">    DWORD ImageBase;</span><br><span class="line">    DWORD SectionAlignment;		<span class="comment">/* 0x20 */</span></span><br><span class="line">    DWORD FileAlignment;</span><br><span class="line">    WORD  MajorOperatingSystemVersion;</span><br><span class="line">    WORD  MinorOperatingSystemVersion;</span><br><span class="line">    WORD  MajorImageVersion;</span><br><span class="line">    WORD  MinorImageVersion;</span><br><span class="line">    WORD  MajorSubsystemVersion;		<span class="comment">/* 0x30 */</span></span><br><span class="line">    WORD  MinorSubsystemVersion;</span><br><span class="line">    DWORD Win32VersionValue;</span><br><span class="line">    DWORD SizeOfImage;</span><br><span class="line">    DWORD SizeOfHeaders;</span><br><span class="line">    DWORD CheckSum;			<span class="comment">/* 0x40 */</span></span><br><span class="line">    WORD  Subsystem;</span><br><span class="line">    WORD  DllCharacteristics;</span><br><span class="line">    DWORD SizeOfStackReserve;</span><br><span class="line">    DWORD SizeOfStackCommit;</span><br><span class="line">    DWORD SizeOfHeapReserve;		<span class="comment">/* 0x50 */</span></span><br><span class="line">    DWORD SizeOfHeapCommit;</span><br><span class="line">    DWORD LoaderFlags;</span><br><span class="line">    DWORD NumberOfRvaAndSizes;</span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES]; <span class="comment">/* 0x60 */</span></span><br><span class="line">    <span class="comment">/* 0xE0 */</span></span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</span><br></pre></td></tr></table></figure>
</li>
<li><p>64 bits Optional Header</p>
  <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IMAGE_OPTIONAL_HEADER64</span> &#123;</span><br><span class="line">    WORD  Magic; <span class="comment">/* 0x20b */</span></span><br><span class="line">    BYTE MajorLinkerVersion;</span><br><span class="line">    BYTE MinorLinkerVersion;</span><br><span class="line">    DWORD SizeOfCode;</span><br><span class="line">    DWORD SizeOfInitializedData;</span><br><span class="line">    DWORD SizeOfUninitializedData;</span><br><span class="line">    DWORD AddressOfEntryPoint;</span><br><span class="line">    DWORD BaseOfCode;</span><br><span class="line">    ULONGLONG ImageBase;</span><br><span class="line">    DWORD SectionAlignment;</span><br><span class="line">    DWORD FileAlignment;</span><br><span class="line">    WORD MajorOperatingSystemVersion;</span><br><span class="line">    WORD MinorOperatingSystemVersion;</span><br><span class="line">    WORD MajorImageVersion;</span><br><span class="line">    WORD MinorImageVersion;</span><br><span class="line">    WORD MajorSubsystemVersion;</span><br><span class="line">    WORD MinorSubsystemVersion;</span><br><span class="line">    DWORD Win32VersionValue;</span><br><span class="line">    DWORD SizeOfImage;</span><br><span class="line">    DWORD SizeOfHeaders;</span><br><span class="line">    DWORD CheckSum;</span><br><span class="line">    WORD Subsystem;</span><br><span class="line">    WORD DllCharacteristics;</span><br><span class="line">    ULONGLONG SizeOfStackReserve;</span><br><span class="line">    ULONGLONG SizeOfStackCommit;</span><br><span class="line">    ULONGLONG SizeOfHeapReserve;</span><br><span class="line">    ULONGLONG SizeOfHeapCommit;</span><br><span class="line">    DWORD LoaderFlags;</span><br><span class="line">    DWORD NumberOfRvaAndSizes;</span><br><span class="line">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class="line">&#125; IMAGE_OPTIONAL_HEADER64, *PIMAGE_OPTIONAL_HEADER64;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="Section-Header"><a href="#Section-Header" class="headerlink" title="Section Header"></a>Section Header</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">_IMAGE_SECTION_HEADER</span> &#123;</span><br><span class="line">    BYTE  Name[IMAGE_SIZEOF_SHORT_NAME];</span><br><span class="line">    <span class="keyword">union</span> &#123;</span><br><span class="line">    DWORD PhysicalAddress;</span><br><span class="line">    DWORD VirtualSize;</span><br><span class="line">    &#125; Misc;</span><br><span class="line">    DWORD VirtualAddress;</span><br><span class="line">    DWORD SizeOfRawData;</span><br><span class="line">    DWORD PointerToRawData;</span><br><span class="line">    DWORD PointerToRelocations;</span><br><span class="line">    DWORD PointerToLinenumbers;</span><br><span class="line">    WORD  NumberOfRelocations;</span><br><span class="line">    WORD  NumberOfLinenumbers;</span><br><span class="line">    DWORD Characteristics;</span><br><span class="line">&#125; IMAGE_SECTION_HEADER, *PIMAGE_SECTION_HEADER;</span><br></pre></td></tr></table></figure>

<p>For the comments of the variables in the code above, you can find them easily in the MSFT official document.</p>
<h2 id="Parse-PE-files"><a href="#Parse-PE-files" class="headerlink" title="Parse PE files"></a>Parse PE files</h2><h3 id="From-image"><a href="#From-image" class="headerlink" title="From image"></a>From image</h3><ol>
<li>Use file handler to read the file into the memory.</li>
<li>fwrite() the first 64 bits into an instance of data structure IMAGE_DOS_HEADER.</li>
<li>Use IMAGE_DOS_HEADER.e_lfanew to get the location of the starting byte of NT Header.</li>
<li>Use fseek() to put the file handler at that byte.</li>
<li>fwrite() the size of NT Header into an instance of data structure IMAGE_NT_HEADER.</li>
<li>Instancialize IMAGE_FILE_HEADER and IMAGE_OPTIONAL_HEADER to store File Header and Optional Header in the instance of NT Header.</li>
<li>Get the value of IMAGE_FILE_HEADER.NumberOfSections</li>
<li>Load the content left from the file handler to a pointer of PIMAGE_SECTION_HEADER type.</li>
<li>Traverse the Section Headers by the pointer.</li>
<li>Traverse the Section Content by the IMAGE_SECTION_HEADER.PointerToRawData and IMAGE_SECTION_HEADER.SizeOfRawData variables.</li>
</ol>
<h3 id="From-Memory"><a href="#From-Memory" class="headerlink" title="From Memory"></a>From Memory</h3><ol>
<li>Use LoadLibrary() to get the handler of a DLL file.</li>
<li>Initialize the pointers of IMAGE_DOS_HEADER, let’s say<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dosHeader = <span class="built_in">LoadLibrary</span>(<span class="string">&quot;Your DLL Name&quot;</span>);</span><br></pre></td></tr></table></figure></li>
<li>Find the address of IMAGE_NT_HEADER, let’s say the instance of it is ntHeader<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntHeader = dosHeader-&gt;e_lfanew + dosHeader;</span><br></pre></td></tr></table></figure></li>
<li>Use IMAGE_FILE_HEADER (fileHeader) and IMAGE_OPTIONAL_HEADER (optionalHeader) to point to the corresponding address<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fileHeader = ntHeader + <span class="built_in">sizeof</span>(DWORD);</span><br><span class="line"></span><br><span class="line">optioanalHeader = fileHeader + <span class="built_in">sizeof</span>(IMAGE_FILE_HEADER);</span><br></pre></td></tr></table></figure></li>
<li>Get the address of the first Section Header (sectionHeader).<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sectionHeader = optionalHeader + fileHeader-&gt;SizeOfOptionalHeader;</span><br></pre></td></tr></table></figure></li>
<li>Browse the content of sections by Section Header<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sectionAddress = optionalHeader-&gt;ImageBase + sectionHeadr-&gt;VitualAddress;</span><br></pre></td></tr></table></figure></li>
</ol>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Recent</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Archives</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Table-of-Content"><span class="toc-number">1.</span> <span class="toc-text">Table of Content</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Basic-Structure"><span class="toc-number">2.</span> <span class="toc-text">Basic Structure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-PE-File"><span class="toc-number">2.1.</span> <span class="toc-text">1. PE File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-MS-DOS-stub"><span class="toc-number">2.2.</span> <span class="toc-text">2. MS-DOS stub</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DOS-Header"><span class="toc-number">2.2.1.</span> <span class="toc-text">DOS Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DOS-stub"><span class="toc-number">2.2.2.</span> <span class="toc-text">DOS stub</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Rich-Header"><span class="toc-number">2.2.3.</span> <span class="toc-text">Rich Header</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-NT-Header"><span class="toc-number">2.3.</span> <span class="toc-text">3. NT Header</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NT-Signature"><span class="toc-number">2.3.1.</span> <span class="toc-text">NT Signature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Header"><span class="toc-number">2.3.2.</span> <span class="toc-text">File Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Optional-Header"><span class="toc-number">2.3.3.</span> <span class="toc-text">Optional Header</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Section-Header"><span class="toc-number">2.4.</span> <span class="toc-text">4. Section Header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-Sections"><span class="toc-number">2.5.</span> <span class="toc-text">5. Sections</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Standard-Sections"><span class="toc-number">2.5.1.</span> <span class="toc-text">Standard Sections</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Self-defined-Sections"><span class="toc-number">2.5.2.</span> <span class="toc-text">Self-defined Sections</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-Appending-Content"><span class="toc-number">2.6.</span> <span class="toc-text">6. Appending Content</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-code-of-the-data-structures-above"><span class="toc-number">3.</span> <span class="toc-text">C++ code of the data structures above</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DOS-Header-1"><span class="toc-number">3.1.</span> <span class="toc-text">DOS Header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NT-Header"><span class="toc-number">3.2.</span> <span class="toc-text">NT Header</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#NT-Signature-1"><span class="toc-number">3.2.1.</span> <span class="toc-text">NT Signature</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#File-Header-1"><span class="toc-number">3.2.2.</span> <span class="toc-text">File Header</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Optional-Header-1"><span class="toc-number">3.2.3.</span> <span class="toc-text">Optional Header</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Section-Header"><span class="toc-number">3.3.</span> <span class="toc-text">Section Header</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Parse-PE-files"><span class="toc-number">4.</span> <span class="toc-text">Parse PE files</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#From-image"><span class="toc-number">4.1.</span> <span class="toc-text">From image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#From-Memory"><span class="toc-number">4.2.</span> <span class="toc-text">From Memory</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&text=PE Format"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&is_video=false&description=PE Format"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=PE Format&body=Check out this article: https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&title=PE Format"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://yuqidai.github.io/2024/04/01/reverse%20engineering/PE%20File/PE_Format/&name=PE Format&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-mid">
    Copyright &copy; 2024 Dai Yuqi ❤️ updated on 18th August 2024.
  </div>
</footer>

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<link rel="stylesheet" href="/lib/meslo-LG/styles.css">


<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>





